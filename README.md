# S7 FAQ MCP Usage Example

This is a simple example of how to use the S7 FAQ search function as MCP server to answer user questions via LLM.

> [!IMPORTANT]
> This repo is only a demo and not a production-ready code. It is meant to be used as a reference for building your own S7 FAQ search function.

---

## Quick Preview

### Simple fancy preview

For a non-executable notebook preview please follow: [Marimo static notebook](https://static.marimo.app/static/s7-mcp-example-m1nz)

### Messy long output:

<details>
<summary><b>Stdio Logs (click me)</b></summary>

```bash
 ❯ uv run src/agent.py                                                
[05/23/25 20:41:25] INFO     Starting MCP server 'S7 FAQ MCP Server' with transport 'stdio'                                                                            server.py:747
Enter your query or press ENTER to use default

 Query [default_query='Билеты в Ростов-на-Дону']: 
╭──────────────────────────────────────────────────────────────────────────────────── New run ─────────────────────────────────────────────────────────────────────────────────────╮
│                                                                                                                                                                                  │
│ Билеты в Ростов-на-Дону                                                                                                                                                          │
│                                                                                                                                                                                  │
╰─ OpenAIServerModel - gemma-3-12b-it ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ Step 1 ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
╭──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Calling tool: 'search' with arguments: {'query': 'билеты в ростов-на-дону'}                                                                                                      │
╰──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
Observations: {
  "articles": |
    "Росавиация регулярно продлевает запрет на полеты в аэропорты юга и центральной части России. Какие аэропорты сейчас 
закрыты:АнапаБелгородБрянскВоронежГеленджикКраснодарКурскЛипецкРостов-на-ДонуСимферопольВыбирайте маршруты через Сочи, Волгоград, Минеральные Воды. Билеты ищите наs7.ruИнформацию о
продлении запрета Росавиация больше не публикует — в СМИ ее найти сложно. Когда ситуация изменится, мы обязательно об этом напишем.",
    "Да, билет оформлять в любом случае нужно. Если ребенок летит у вас на руках, то это бесплатно при перелетах по России, на международных перелетах скидка составит 90% от тарифа
для взрослого.Если же вы хотите, чтобы у малыша было отдельное кресло, выбирайте билет как для ребёнка.Подробнее",
    "Можете, если вылетаете по России из этих аэропортов:БарнаулБлаговещенскВладивосток (только для перелетов по России)ВолгоградЕкатеринбургИркутск (только для перелетов по 
России)КазаньКалининградКрасноярскМинеральные ВодыМосква Домодедово (только для перелетов по России)НижнекамскНовокузнецкНовосибирск (только для перелетов по России)Новый 
УренгойОмскПермь (только для перелетов по России)Ростов-на-ДонуСанкт-ПетербургСамараСаратовСочиСургутТюменьУфаПетропавловск-КамчатскийЧелябинскЧитаЮжно-СахалинскЯкутскВ аэропортах 
других российских городов воспользоваться мобильным посадочным не получится: его нужно обязательно распечатать.Как это сделать?Если вы вылетаете в Россию из-за рубежа, вам 
необходимо получить посадочный талон на стойке регистрации, кроме аэропортов:АлматыАстанаБакуБангкокаБишкекПхукетСтамбулУсть-КаменогорскУ-ТапаоВылетая из этих аэропортов, вы можете
воспользоваться мобильным посадочным.",
    "Да! За каждый перелет, оплаченный с помощью Miles & Cash, путешественники получают бонусные и статусные мили. Количество миль рассчитывается в определенной пропорции. Все 
зависит от того, какая часть билета оплачена рублями, а какая милями. Чем больше денежная доля, тем больше бонусных и статусных миль будет начислено. Например, рейс Москва — 
Иркутск — это 2 613 миль, то есть 100%. Если оплатить деньгами 90% билета, включая сборы, можно получить 90% миль. Покупая билет в Иркутск таким образом, вы получите 2 350 бонусных
и статусных миль.Если перелет был оплачен полностью милями с помощью Miles and Cash, то бонусные и статусные мили не начисляются.",
    "Во время поиска на сайте мы в первую очередь покажем вам вариант с самой низкой ценой на выбранную дату. Если вы хотите купить билет еще выгоднее, посмотрите, сколько стоят 
билеты на другие даты.Еще вы можете воспользоватьсяспециальными предложениями от S7 Airlinesилиподписаться на рассылку,чтобы не упустить билет по самой выгодной цене.",
    "Билеты, частично оплаченные милями, можно вернуть или обменять, если это позволяют правила тарифа. Сделать это можно самостоятельно в разделе«Мои бронирования».Что-либо 
изменить в билете вы сможете в Контактном центре:напишите нам в чатена сайте или в мобильном приложении.Рекомендуем обращаться в сервисный центр заранее, так как процедура внесения
изменений в билет может занять некоторое время.Обратите внимание:Сборы за изменения оплатить милями не получится. Если после внесения изменений стоимость билета увеличилась, все 
доплаты можно будет сделать только рублями.",
    "Нет, вы не можете получить мили за перелеты других пассажиров, даже если они приходятся вам близкими родственниками. Таковыправила программы.А еще вы можете создатьсемейный 
счети копить мили вместе.",
    "Билеты на Аэроэкспресс можно купить на сайте и в приложении S7 Airlines прямо во время бронирования авиабилетов.Выберите направление, даты, подходящие по цене авиабилеты, 
пассажиров и нажмите «Далее»Вы окажетесь на страничке «Дополнительные услуги». Самое время взять билеты на АэроэкспрессДаты вылета определятся автоматически — можно будет выбрать 
билеты туда-обратно или только в одном направлении. А ещепроверить расписание поездовОплатите Аэроэкспресс милямиили получите мили за оплату картой. Пока что оплата милями работает
на сайте и в приложении на iOSЕсли не решитесь сразу — есть вариант докупить позже: в разделе «Мои бронирования» на сайте или в разделе «Путешествия» в приложении.В приложении вы 
также можете купить билет на Аэроэкспресс без билета на самолет. На сайте пока что можно только с билетом на рейс S7 Airlines.",
    "Да! За каждый перелет, оплаченный с помощью Miles & Cash, путешественники получают 1 статусный сегмент. Сегмент равняется одному участку полета. Например, рейс Новосибирск — 
Москва — это 1 сегмент, а рейс Новосибирск — Москва — Сочи — это уже 2 сегмента. Вы получаете 1 сегмент при любом проценте денежной оплаты, кроме случаев 100 процентной оплаты 
тарифа милями, что гораздо быстрее приближает вас к следующему статусу в программе!",
    "Если в вашем маршруте несколько перелетов и ни одним из них вы еще не воспользовались, то оба билета можно только вернуть, поменять на другую дату нельзя. Если какие-то 
перелеты в маршруте вы уже совершили, а другие еще нет, то билеты можно и вернуть, и поменять  — на любую дату, пока они действительны. Кстати, срок действия билета можно продлить 
на время болезни пассажира, если есть подтверждающие медицинские документы (требования к нимздесь). Чтобы поменять билет, обратитесь туда, где вы его купили, илив ближайший офис S7
Airlines."
  ]
}
[Step 1: Duration 7.05 seconds| Input tokens: 1,471 | Output tokens: 38]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ Step 2 ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
╭──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Calling tool: 'final_answer' with arguments: {'answer': 'Согласно предоставленной информации, аэропорт Ростова-на-Дону в настоящее время закрыт. Рекомендуется выбирать маршруты │
│ через Сочи, Волгоград или Минеральные Воды.'}                                                                                                                                    │
╰──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
Final answer: Согласно предоставленной информации, аэропорт Ростова-на-Дону в настоящее время закрыт. Рекомендуется выбирать маршруты через Сочи, Волгоград или Минеральные Воды.
[Step 2: Duration 3.25 seconds| Input tokens: 4,779 | Output tokens: 108]

```

</details>

---

## How to run this example

1. Install `uv`
2. Create a `.env` file in the root directory from the `.env.example` file and fill in the required fields:
   - `MODEL_NAME`: The name of the model you are using (e.g. `llama2-7b-chat`)
   - `API_BASE_URL`: The base URL of the OpenAI API Compatible server (e.g. `http://localhost:8000/v1`)
   - `API_KEY`: The API key for authentication (if required)
3. Run `uv run src/agent.py` in the terminal
4. Optionally, you can run `uv run marimo edit` and run the `notebooks/agent.py` in the browser
